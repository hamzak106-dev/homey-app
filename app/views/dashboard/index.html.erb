<div class="container mt-5">
  <h1 class="text-center">Welcome to Your Dashboard, <%= current_user.email %>!</h1>

  <h2 class="mt-4">Your Projects</h2>
  <%= link_to "New Project", new_project_path, class: "btn btn-primary mb-3" %>

  <% if @projects.any? %>
    <div class="list-group">
      <% @projects.each do |project| %>
        <div class="list-group-item">
          <h3><%= link_to project.name, project_path(project) %></h3>
          <p><strong>Status:</strong> <%= project.status %></p>
          <p>
            <strong>Owner:</strong> 
            <%= project.user.present? ? "#{project.user.first_name} #{project.user.last_name}" : project.user.email %>
          </p>


          <h4>Comments</h4>
          <% if project.comments.any? %>
            <ul>
              <% project.comments.each do |comment| %>
                <li>
                  <strong><%= comment.user.email %>:</strong>
                  <%= comment.content %>
                </li>
              <% end %>
            </ul>
          <% else %>
            <p>No comments yet.</p>
          <% end %>

          <%= form_with model: [project, project.comments.build], local: true do |f| %>
            <div class="form-group">
              <%= f.text_area :content, class: "form-control", placeholder: "Add a comment" %>
            </div>
            <%= f.submit "Add Comment", class: "btn btn-secondary" %>
          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <p>You have no projects yet. <%= link_to "Create a new project", new_project_path %>.</p>
  <% end %>
</div>